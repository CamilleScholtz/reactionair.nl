{{ define "main" }}
	<article>
		<section class="hero">
			<section class="authors">
				{{ range $index, $author := .Params.authors }}
					<a href="/auteurs/{{ urlize $author }}">{{ $author }}</a>{{ if ne (add $index 1) (len $.Params.authors) }},&nbsp{{ end }}
				{{ end }}
			</section>

			<section class="title">
				<h1>{{ .Params.title | safeHTML }}</h1>
				<h2>{{ .Params.subtitle | safeHTML }}</h2>
			</section>

			<figure>
				{{ $image := .Resources.GetMatch .Params.image }}
				{{ $anchor := "Smart" }}
				{{ if isset .Params "anchor" }}
					{{ $anchor = .Params.anchor }}
				{{ end }}

				{{ $1x := $image.Fill (printf "1035x500 webp %s" $anchor) }}
				{{ $2x := $image.Fill (printf "2070x1000 webp %s" $anchor) }}

				<img
					srcset="{{ $1x.RelPermalink }} 1x,
					        {{ $2x.RelPermalink }} 2x"
					src="{{ $2x.RelPermalink }}"
					alt="{{ if isset .Params "caption" }}{{ .Params.caption }}{{ else }}{{ .Params.title | safeHTML }}{{ end }}"
					style="background: {{ index $1x.Colors 0 }};">

				{{ if isset .Params "caption" }}
					<figcaption>{{ .Params.caption }}</figcaption>
				{{ end }}
			</figure>

			<section class="info">
				<time>{{ .Date.Day }} {{ index site.Data.months (printf "%d" .Date.Month) }}, {{ .Date.Year }}</time>

				<span class="pipe">â€”</span>

				<span class="eta" data-eta="{{ .ReadingTime }}">{{ .ReadingTime }} {{ if gt .ReadingTime 1 }}minuten{{ else }}minuut{{ end }} leestijd</span>
			</section>
		</section>

		<section class="content">
			{{ if isset .Params "note" }}
				<section class="note">
					<small>{{ .Params.note | markdownify }}</small>
				</section>
			{{ end }}

			{{ .Content }}

			{{ if isset .Params "cited" }}
				<section class="cited">
					<p>Aangehaald in dit artikel:</p>

					{{ range .Params.cited }}
						<a href="/aangehaald/{{ urlize . }}">{{ . }}</a>
					{{ end }}
				</section>
			{{ end }}
		</section>
	</article>

	{{ if in (slice "Politiek en Actualiteit" "Cultuur en Maatschappij" "Religie en Wijsbegeerte" "Onderzoek en Speurwerk" "Recensie en Biografie" "Klikaas") .Params.themes }}
		<section class="files">
			{{ $side        := "right" }}
			{{ $filesTitles := slice }}

			{{ if isset .Params "files" }}
				{{ range $i, $file := .Params.files }}
					{{ $pages := where site.RegularPages "Params.files" "intersect" (slice $file) }}
					{{ $pages  = where $pages "Params.title" "ne" $.Params.title }}
					{{ $pages  = first 5 $pages }}

					{{ range $pages }}
						{{ $filesTitles = $filesTitles | append .Params.title }}
					{{ end }}

					{{ if mod $i 2 }}
						{{ $side = "left" }}
					{{ end }}

					{{ partial "articles/theme.html" (dict
						"context" .
						"section" "files"
						"path"    "dossiers"
						"term"    $file
						"pages"   $pages
						"side"    $side
					) }}
				{{ end }}
			{{ end }}

			{{ $pages := site.RegularPages.Related . }}
			{{ if gt (len $filesTitles) 0 }}
				{{ $pages  = where $pages "Params.title" "not in" $filesTitles }}
			{{ end }}
			{{ $pages  = first 5 $pages }}

			{{ if eq $side "right" }}
				{{ $side = "left" }}
			{{ else }}
				{{ $side = "right" }}
			{{ end }}

			{{ partial "articles/theme.html" (dict
				"context" .
				"section" "related"
				"path"    "themas"
				"term"    .Params.themes
				"pages"   $pages
				"side"    $side
			) }}
		</section>
	{{ end }}

	<section id="comments">
		{{ partial "comments/comments" . }}
	</section>
{{ end }}
