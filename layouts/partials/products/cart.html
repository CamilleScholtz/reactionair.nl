{{ $variants := .variants }}
{{ if not .checkout }}
	{{ $variants = slice (index .variants 0) }}
{{ end }}

{{ range $index, $_ := $variants }}
	<div class="cart-form" data-variant="{{ .id }}" data-price="{{ .price }}" style="display: {{ cond (eq $index 0) (cond $.checkout "grid" "block") "none" }};">
		<div class="price">
			{{ if not $.checkout }}
				{{ if not $.out_of_stock }}
					{{ range $i, $variant := $.variants }}
						{{ $int := int .price }}
						{{ $dec := sub .price $int }}

						€ {{ $int }}.<span class="decimals">{{ strings.TrimPrefix "0." (printf "%.2f" $dec) }}</span>

						{{ if lt (add $i 1) (len $.variants) }}
							/&nbsp;
						{{ end }}
					{{ end }}
				{{ else }}
					<span class="unavailable">Niet beschikbaar.</span>
				{{ end }}
			{{ else }}
				{{ if not .out_of_stock }}
					{{ $int := int .price }}
					{{ $dec := sub .price $int }}

					€ {{ $int }}.<span class="decimals">{{ strings.TrimPrefix "0." (printf "%.2f" $dec) }}</span>
				{{ else }}
					<span class="unavailable">Niet beschikbaar.</span>
				{{ end }}
			{{ end }}
		</div>

		{{ if and (not $.checkout) (gt (len $.variants) 1) }}
			<a href="{{ $.permalink }}" class="button {{ if $.out_of_stock }}disabled{{ end }}" {{ if $.out_of_stock }}disabled{{ end }}>
				Toevoegen aan winkelwagen
			</a>
		{{ else }}
			<button class="button add-to-cart {{ if .out_of_stock }}disabled{{ end }}" {{ if .out_of_stock }}disabled{{ end }}>
				Toevoegen aan winkelwagen
			</button>
		{{ end }}

		<div class="added-to-cart" style="display: none;">
			<button class="button remove-from-cart {{ if .out_of_stock }}disabled{{ end }}" {{ if .out_of_stock }}disabled{{ end }}>
				-
			</button>

			<input class="amount-in-cart {{ if .out_of_stock }}disabled{{ end }}" type="number" value="1" min="1" max="10" {{ if .out_of_stock }}disabled{{ end }}>

			<button class="button add-to-cart {{ if .out_of_stock }}disabled{{ end }}" {{ if .out_of_stock }}disabled{{ end }}>
				+
			</button>

			{{ if $.checkout }}
				<a href="/winkel/wagen" class="button checkout">
					Afrekenen
				</a>
			{{ end }}
		</div>
	</div>
{{ end }}

{{ if and .checkout (gt (len $variants) 1) }}
	<div class="variants filters">
		<span class="title">Variant:</span>

		<span class="filters-container">
			{{ range $index, $_ := $variants }}
				<a href="#" class="{{ cond (eq $index 0) "active" "" }}" data-variant="{{ .id }}">{{ .format | title }}</a>
			{{ end }}
		</span>
	</div>
{{ end }}
