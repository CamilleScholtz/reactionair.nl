{{$page  := include "/zoeken/index.md" | splitFrontMatter}}
{{$query := index .Req.URL.Query.q 0 | lower}}

{{$articles := dict}}
{{range $v := listFiles "/artikelen"}}
	{{$p := printf "/artikelen/%s/index.md" $v | include | splitFrontMatter}}

	{{if $p.Meta.visible}}
		{{if contains $query ($p.Body | lower)}}
			{{$_ := set $articles $p.Meta.published (dict "Meta" $p.Meta "Slug" $v)}}
		{{end}}
	{{end}}
{{end}}


<!DOCTYPE html>

<html lang="nl">
	{{include "/static/html/head.html" $page.Meta}}

	<body>
		{{include "/static/html/header.html" $page.Meta}}

		{{if not $articles}}
			<div id="misc-container">
				<p>Geen artikelen gevonden met de zoekterm <i>“{{html $query}}”</i>!</p>
			</div>
		{{else}}
			<div id="list-container">
				{{$i := 0}}
				{{range $v := $articles}}
					<a href="/artikelen/{{$v.Slug}}" class="article" style="order: {{$i}};">
						<img src="/artikelen/{{$v.Slug}}/thumb.webp">
						<h1>{{$v.Meta.title}}</h1>
						<h2>{{$v.Meta.subtitle}}</h2>
						<p class="author">{{$v.Meta.author}}</p>

						<p class="category">{{upper $v.Meta.category}}</p>
					</a>

					{{$i = sub $i 1}}
				{{end}}
			</div>
		{{end}}

		{{include "/static/html/footer.html"}}
	</body>
</html>
